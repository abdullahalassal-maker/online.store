/* ==================== main.js ==================== */

/* --------- Translation data --------- */
const data118 = {
  en: {
    navHome: "Home",
    navAbout: "About",
    navLaptops: "Laptops",
    navAccessories: "Accessories",
    navTelephones: "Telephones",
    navContact: "Contact",
    aboutTitle: "About Code-Nestio",
    aboutText: `Welcome to Code-Nestio, your number one source for electronics. 
We're dedicated to giving you the very best of laptops, phones, and accessories, with a focus on quality, customer service, and uniqueness. 
Our mission is to provide customers with a seamless online shopping experience. We offer in-depth product descriptions, high-quality images, and expert reviews. 
Our dedicated support team is always ready to help with your queries and ensure a smooth purchase process. 
At Code-Nestio, we believe in innovation and constantly update our inventory with the latest technology. 
Whether you are looking for cutting-edge laptops, powerful smartphones, or trendy accessories, we have everything to suit your lifestyle and needs. 
Customer satisfaction is our top priority, and we strive to build long-lasting relationships by offering reliable products, fair pricing, and fast delivery. 
Join thousands of happy customers and explore our collection today!`,
    laptopsTitle: "Our Laptops",
    accessoriesTitle: "Our Accessories",
    telephonesTitle: "Our Telephones",
    contactTitle: "Contact Us",
    contactText: "Reach out to Code-Nestio for any questions or inquiries!",
    cardTitles: [
      "High Performance Laptops",
      "Top Accessories",
      "Latest Smartphones"
    ],
    cardTexts: [
      "Discover our selection of high performance laptops, perfect for work, gaming, and creative projects.",
      "Enhance your gadgets with our top quality accessories. From chargers to headphones, we have everything you need.",
      "Stay connected with the latest smartphones. Explore the newest models with advanced features and sleek designs."
    ],
   heroTitles: ["Welcome to Code-Nestio", "Latest Laptops", "Top Accessories"],
heroSubtitles: [
  "The best electronics store for laptops, phones & accessories",
  "High performance & sleek design",
  "Boost your gadgets experience"
],heroButton: ["Shop Now", "Shop Now", "Shop Now"],


  },
  ar: {
    navHome: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
    navAbout: "Ø¹Ù† Ø§Ù„Ù…ØªØ¬Ø±",
    navLaptops: "Ø§Ù„Ø­ÙˆØ§Ø³ÙŠØ¨",
    navAccessories: "Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª",
    navTelephones: "Ø§Ù„Ù‡ÙˆØ§ØªÙ",
    navContact: "ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§",
    aboutTitle: "Ø¹Ù† Code-Nestio",
    aboutText: `Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨ÙƒÙ… ÙÙŠ Code-NestioØŒ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª. 
Ù†Ø­Ù† Ù…Ù„ØªØ²Ù…ÙˆÙ† Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø£ÙØ¶Ù„ Ø§Ù„Ø­ÙˆØ§Ø³ÙŠØ¨ ÙˆØ§Ù„Ù‡ÙˆØ§ØªÙ ÙˆØ§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§ØªØŒ Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„ØªÙØ±Ø¯. 
Ù…Ù‡Ù…ØªÙ†Ø§ Ù‡ÙŠ ØªÙ‚Ø¯ÙŠÙ… ØªØ¬Ø±Ø¨Ø© ØªØ³ÙˆÙ‚ Ø³Ù„Ø³Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. Ù†ÙˆÙØ± ÙˆØµÙÙ‹Ø§ Ù…ÙØµÙ„Ø§Ù‹ Ù„Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ ØµÙˆØ±Ù‹Ø§ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø§Øª Ø®Ø¨Ø±Ø§Ø¡. 
ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø®ØµØµ Ù„Ø¯ÙŠÙ†Ø§ Ø¬Ø§Ù‡Ø² Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ÙŠØ© Ø´Ø±Ø§Ø¡ Ø³Ù„Ø³Ø©. 
ÙÙŠ Code-NestioØŒ Ù†Ø¤Ù…Ù† Ø¨Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø± ÙˆÙ†Ø¹Ù…Ù„ Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±. 
Ø³ÙˆØ§Ø¡ ÙƒÙ†Øª ØªØ¨Ø­Ø« Ø¹Ù† Ø­ÙˆØ§Ø³ÙŠØ¨ Ù…ØªØ·ÙˆØ±Ø©ØŒ Ù‡ÙˆØ§ØªÙ Ø°ÙƒÙŠØ© Ù‚ÙˆÙŠØ©ØŒ Ø£Ùˆ Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø¹ØµØ±ÙŠØ©ØŒ Ù„Ø¯ÙŠÙ†Ø§ ÙƒÙ„ Ù…Ø§ ÙŠÙ†Ø§Ø³Ø¨ Ø£Ø³Ù„ÙˆØ¨ Ø­ÙŠØ§ØªÙƒ ÙˆØ§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ. 
Ø±Ø¶Ø§ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù‡Ùˆ Ø£ÙˆÙ„ÙˆÙŠØªÙ†Ø§ Ø§Ù„Ù‚ØµÙˆÙ‰ØŒ ÙˆÙ†Ø³Ø¹Ù‰ Ù„Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ø§Ù‚Ø§Øª Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ø£Ù…Ø¯ Ù…Ù† Ø®Ù„Ø§Ù„ ØªÙ‚Ø¯ÙŠÙ… Ù…Ù†ØªØ¬Ø§Øª Ù…ÙˆØ«ÙˆÙ‚Ø©ØŒ Ø£Ø³Ø¹Ø§Ø± Ø¹Ø§Ø¯Ù„Ø©ØŒ ÙˆØªØ³Ù„ÙŠÙ… Ø³Ø±ÙŠØ¹. 
Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø¢Ù„Ø§Ù Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø³Ø¹Ø¯Ø§Ø¡ ÙˆØ§Ø³ØªÙƒØ´Ù Ù…Ø¬Ù…ÙˆØ¹ØªÙ†Ø§ Ø§Ù„ÙŠÙˆÙ…!`,
    laptopsTitle: "Ø­ÙˆØ§Ø³ÙŠØ¨Ù†Ø§",
    accessoriesTitle: "Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ù„Ø¯ÙŠÙ†Ø§",
    telephonesTitle: "Ù‡ÙˆØ§ØªÙÙ†Ø§",
    contactTitle: "ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§",
    contactText: "ØªÙˆØ§ØµÙ„ Ù…Ø¹ Code-Nestio Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ùˆ Ø£Ø³Ø¦Ù„Ø©!",
    cardTitles: [
      "Ø­ÙˆØ§Ø³ÙŠØ¨ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø£Ø¯Ø§Ø¡",
      "Ø£ÙØ¶Ù„ Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª",
      "Ø£Ø­Ø¯Ø« Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©"
    ],
    cardTexts: [
      "Ø§Ø³ØªÙƒØ´Ù Ù…Ø¬Ù…ÙˆØ¹ØªÙ†Ø§ Ù…Ù† Ø§Ù„Ø­ÙˆØ§Ø³ÙŠØ¨ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø£Ø¯Ø§Ø¡ØŒ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©.",
      "Ø­Ø³Ù‘Ù† ØªØ¬Ø±Ø¨Ø© Ø£Ø¬Ù‡Ø²ØªÙƒ Ù…Ø¹ Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§ØªÙ†Ø§ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©. Ù…Ù† Ø§Ù„Ø´ÙˆØ§Ø­Ù† Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù…Ø§Ø¹Ø§ØªØŒ Ù„Ø¯ÙŠÙ†Ø§ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡.",
      "Ø§Ø¨Ù‚ÙŽ Ù…ØªØµÙ„Ø§Ù‹ Ù…Ø¹ Ø£Ø­Ø¯Ø« Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©. Ø§ÙƒØªØ´Ù Ø£Ø­Ø¯Ø« Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ù…Ø¹ Ù…ÙŠØ²Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆØªØµØ§Ù…ÙŠÙ… Ø£Ù†ÙŠÙ‚Ø©."
    ],
 heroTitles: ["Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨ÙƒÙ… ÙÙŠ Code-Nestio", "Ø£Ø­Ø¯Ø« Ø§Ù„Ø­ÙˆØ§Ø³ÙŠØ¨", "Ø£ÙØ¶Ù„ Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª"],
heroSubtitles: [
  "Ø£ÙØ¶Ù„ Ù…ØªØ¬Ø± Ù„Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª Ù…Ù† Ø­ÙˆØ§Ø³ÙŠØ¨ ÙˆÙ‡ÙˆØ§ØªÙ ÙˆØ§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª",
  "Ø£Ø¯Ø§Ø¡ Ø¹Ø§Ù„ÙŠ ÙˆØªØµÙ…ÙŠÙ… Ø£Ù†ÙŠÙ‚",
  "Ø¹Ø²Ø² ØªØ¬Ø±Ø¨Ø© Ø£Ø¬Ù‡Ø²ØªÙƒ Ù…Ø¹ Ø£ÙØ¶Ù„ Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª"
],heroButton: ["ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†", "ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†", "ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†"],

  }
};

function updateHeroText(lang) {
  const heroSlides = document.querySelectorAll('.hero-slide');
  heroSlides.forEach((slide, i) => {
    const title = slide.querySelector('.hero-title');
    const subtitle = slide.querySelector('.hero-subtitle');
    const btn = slide.querySelector('button');
    if (title) title.textContent = data118[lang].heroTitles[i];
    if (subtitle) subtitle.textContent = data118[lang].heroSubtitles[i];
    if (btn) btn.textContent = data118[lang].heroButton[i];
  });
};
function updateCardsText(lang) {
  const cards = document.querySelectorAll('.card');
  const titles = data118[lang].cardTitles;
  const texts = data118[lang].cardTexts;
  cards.forEach((card, i) => {
    const cardTitle = card.querySelector('.card-title');
    const cardText = card.querySelector('.card-text');
    if (cardTitle && titles[i % titles.length]) cardTitle.textContent = titles[i % titles.length];
    if (cardText && texts[i % texts.length]) cardText.textContent = texts[i % texts.length];
  });
}


/* ===== Helper safe-getters ===== */
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

/* ===== Hero Slider 3D ===== */
const slides = $$('.hero-slide');
const prevBtn = $('.hero-prev');
const nextBtn = $('.hero-next');
const indicators = $$('.hero-indicators span');
let currentSlide = 0;

function showSlide(index) {
  if (!slides.length) return;
  slides.forEach((slide, i) => {
    slide.classList.remove('active', 'prev', 'next');
    if (i === index) slide.classList.add('active');
    else if (i === (index - 1 + slides.length) % slides.length) slide.classList.add('prev');
    else if (i === (index + 1) % slides.length) slide.classList.add('next');
  });
  indicators.forEach((dot, i) => dot.classList.toggle('active', i === index));
}

if (slides.length) showSlide(currentSlide);

if (prevBtn) {
  prevBtn.addEventListener('click', () => {
    currentSlide = (currentSlide - 1 + slides.length) % slides.length;
    showSlide(currentSlide);
    restartAutoSlide();
  });
}

if (nextBtn) {
  nextBtn.addEventListener('click', () => {
    currentSlide = (currentSlide + 1) % slides.length;
    showSlide(currentSlide);
    restartAutoSlide();
  });
}

indicators.forEach((dot, i) => {
  dot.addEventListener('click', () => {
    currentSlide = i;
    showSlide(currentSlide);
    restartAutoSlide();
  });
});

/* ===== Auto Slide Hero ===== */
let autoSlideInterval = 3000;
let autoSlide = null;

function startAutoSlide() {
  if (!slides.length || slides.length <= 1) return;
  clearInterval(autoSlide);
  autoSlide = setInterval(() => {
    currentSlide = (currentSlide + 1) % slides.length;
    showSlide(currentSlide);
  }, autoSlideInterval);
}

function restartAutoSlide() {
  clearInterval(autoSlide);
  startAutoSlide();
}

startAutoSlide();

/* ===== Dark Mode & Language ===== */
const darkModeBtn = $('#darkModeToggle');
const langToggleBtn = $('#langToggle');

/* Load saved theme */
const savedTheme = localStorage.getItem('theme') || 'light';
applyTheme(savedTheme);

/* Load saved language */
const savedLang = localStorage.getItem('lang') || 'en';
document.documentElement.lang = savedLang;
document.body.dir = savedLang === 'ar' ? 'rtl' : 'ltr';

/* Update texts on load */
updateNavbarText(savedLang);
updateAboutText(savedLang);
updatePageTitles(savedLang);
updateHeroText(savedLang);
updateCardsText(savedLang);

/* Dark Mode toggle */
if (darkModeBtn) {
  darkModeBtn.addEventListener('click', () => {
    const isDark = document.body.classList.contains('dark-mode');
    const newTheme = isDark ? 'light' : 'dark';
    applyTheme(newTheme);
    localStorage.setItem('theme', newTheme);
  });
}

/* Language toggle */
if (langToggleBtn) {
  langToggleBtn.addEventListener('click', () => {
    const currentLang = document.documentElement.lang === 'ar' ? 'en' : 'ar';
    document.documentElement.lang = currentLang;
    document.body.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
    localStorage.setItem('lang', currentLang);
    updateNavbarText(currentLang);
    updateAboutText(currentLang);
    updatePageTitles(currentLang);
    updateCardsText(currentLang);
    updateHeroText(currentLang);

  });
}

/* ===== Apply theme function ===== */
function applyTheme(theme) {
  const bg = $('#threeD-bg');
  if (theme === 'dark') {
    document.body.classList.add('dark-mode');
    if (darkModeBtn) darkModeBtn.innerHTML = 'â˜€ï¸';
    if (bg) bg.style.background = 'radial-gradient(circle at 50% 50%, #111, #000)';
  } else {
    document.body.classList.remove('dark-mode');
    if (darkModeBtn) darkModeBtn.innerHTML = 'ðŸŒ™';
    if (bg) bg.style.background = 'radial-gradient(circle at 50% 50%, #1c4391, #454444)';
  }
}

/* ===== Update About text ===== */
function updateAboutText(lang) {
  const aboutTitle = $('#aboutTitle');
  const aboutText = $('.container p');
  if (aboutTitle) aboutTitle.textContent = data118[lang].aboutTitle;
  if (aboutText) aboutText.innerHTML = data118[lang].aboutText;
}

/* ===== Update page section titles ===== */
function updatePageTitles(lang) {
  const laptopsTitle = $('#laptopsTitle');
  const contactTitle = $('#contactTitle');
  const contactText = $('.contact p');
  if (laptopsTitle) laptopsTitle.textContent = data118[lang].laptopsTitle;
  if (contactTitle) contactTitle.textContent = data118[lang].contactTitle;
  if (contactText) contactText.textContent = data118[lang].contactText;
}

/* ===== Update Cards text ===== */
function updateCardsText(lang) {
  const cards = $$('.card');
  const titles = data118[lang].cardTitles;
  const texts = data118[lang].cardTexts;
  cards.forEach((card, i) => {
    const cardTitle = card.querySelector('.card-title');
    const cardText = card.querySelector('.card-text');
    if (cardTitle && titles[i % titles.length]) cardTitle.textContent = titles[i % titles.length];
    if (cardText && texts[i % texts.length]) cardText.textContent = texts[i % texts.length];
  });
}

/* ===== Navbar translation updater ===== */
function updateNavbarText(lang) {
  try {
    if (!data118 || !data118[lang]) return;
    const map = {
      'nav-home': data118[lang].navHome,
      'nav-about': data118[lang].navAbout,
      'nav-laptops': data118[lang].navLaptops,
      'nav-accessories': data118[lang].navAccessories,
      'nav-telephones': data118[lang].navTelephones,
      'nav-contact': data118[lang].navContact
    };
    Object.keys(map).forEach(id => {
      const el = document.getElementById(id);
      if (el) el.textContent = map[id];
    });
  } catch (err) {
    console.error('updateNavbarText error', err);
  }
}

/* ===== 3D Background Particles ===== */
const bg = $('#threeD-bg');
function createParticles(count = 150) {
  if (!bg) return;
  if (bg.dataset.particlesCreated === '1') return;
  for (let i = 0; i < count; i++) {
    const particle = document.createElement('div');
    particle.classList.add('particle');
    particle.style.left = Math.random() * 100 + '%';
    particle.style.top = Math.random() * 100 + '%';
    const size = Math.random() * 4 + 2;
    particle.style.width = size + 'px';
    particle.style.height = size + 'px';
    particle.style.animationDuration = (Math.random() * 10 + 5) + 's';
    bg.appendChild(particle);
  }
  bg.dataset.particlesCreated = '1';
}
createParticles(150);

/* ===== Cards 3D mouse tilt ===== */
const cards = $$('.card');
cards.forEach(card => {
  card.addEventListener('mousemove', (e) => {
    const rect = card.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const midX = rect.width / 2;
    const midY = rect.height / 2;
    const rotateY = ((x - midX) / midX) * 10;
    const rotateX = -((y - midY) / midY) * 10;
    card.style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg) scale(1.05)`;
  });
  card.addEventListener('mouseleave', () => {
    card.style.transform = 'rotateY(0deg) rotateX(0deg) scale(1)';
  });
});

/* ===== Ensure autoSlide restarts on visibility change ===== */
document.addEventListener('visibilitychange', () => {
  if (document.hidden) clearInterval(autoSlide);
  else startAutoSlide();
});
